
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Running &#8212; commandment 1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="API Reference" href="../../api/index.html" />
    <link rel="prev" title="Architecture" href="architecture.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../http-routingtable.html" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../api/index.html" title="API Reference"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="architecture.html" title="Architecture"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">commandment 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Developer Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Developer Guide</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Contents</h2>
    <div class="sidebar-localtoc">
      <ul>
<li><a class="reference internal" href="#">Running</a><ul>
<li><a class="reference internal" href="#backend">Backend</a></li>
<li><a class="reference internal" href="#database">Database</a></li>
<li><a class="reference internal" href="#frontend">Frontend</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
</div>
  <h4>Previous topic</h4>
  <p class="topless"><a href="architecture.html"
                        title="previous chapter">Architecture</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../../api/index.html"
                        title="next chapter">API Reference</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/developer/guide/running.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../../index.html">Docs</a></li>
              
                <li><a href="../index.html">Developer Documentation</a></li>
              
                <li><a href="index.html">Developer Guide</a></li>
              
              <li>Running</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="running">
<h1>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h1>
<div class="section" id="backend">
<h2>Backend<a class="headerlink" href="#backend" title="Permalink to this headline">¶</a></h2>
<p>Before you get started, make a copy of <code class="docutils literal notranslate"><span class="pre">settings.cfg.example</span></code> and name it <code class="docutils literal notranslate"><span class="pre">settings.cfg</span></code>.</p>
<p>Note the settings for <code class="docutils literal notranslate"><span class="pre">SSL_CERTIFICATE</span></code> and <code class="docutils literal notranslate"><span class="pre">SSL_RSA_KEY</span></code>. SSL Certificates are required to run an MDM.
You’ll have to generate those yourself, and they can be self-signed as long as you install trust profiles on your test
device(s).</p>
<p>If you want to use Python debugging, it’s a lot easier with the Flask development server. This is the recommended way
to develop commandment.</p>
<p>Because MDM requires an SSL connection, the <code class="docutils literal notranslate"><span class="pre">flask</span> <span class="pre">run</span></code> command won’t work out of the box.</p>
<p>For this, We’ve provided a command line application which runs the development server with an SSL context.
The command line application is contained in <code class="docutils literal notranslate"><span class="pre">commandment.cli</span></code>.</p>
<p>Assuming you have installed all the Pipenv dependencies, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">COMMANDMENT_SETTINGS</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">settings</span><span class="o">.</span><span class="n">cfg</span> <span class="n">pipenv</span> <span class="n">run</span> <span class="n">commandment</span>
</pre></div>
</div>
<p>From the checked-out git repository.</p>
<p>This will start an SSL server on port 5443, using the private key and certificate specified in the <code class="file docutils literal notranslate"><span class="pre">settings.cfg</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The backend will assume that you are also running a webpack-dev-server <a class="footnote-reference" href="#f1" id="id1">[1]</a> (front end dev server) if the
setting <code class="docutils literal notranslate"><span class="pre">DEBUG</span> <span class="pre">=</span> <span class="pre">True</span></code>. This is extremely useful for seeing javascript changes on the fly.</p>
</div>
</div>
<div class="section" id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h2>
<p>commandment is configured by default to use an SQLite database (commandment.db) in the same directory as the repository.</p>
<p>To initialise the database you should use the <code class="docutils literal notranslate"><span class="pre">alembic</span></code> tool, which was part of our python dependencies.</p>
<p>To do this, change to the commandment directory and run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pipenv run alembic upgrade head
</pre></div>
</div>
<p>This runs the alembic tool inside the pipenv virtual environment.</p>
</div>
<div class="section" id="frontend">
<h2>Frontend<a class="headerlink" href="#frontend" title="Permalink to this headline">¶</a></h2>
<p>When running the backend on the dev server, front-end assets will be loaded from <strong>localhost</strong> on port <strong>4000</strong>.</p>
<p>To start the webpack dev server <a class="footnote-reference" href="#f1" id="id2">[1]</a>, run the following command inside the <code class="file docutils literal notranslate"><span class="pre">ui</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NODE_ENV</span><span class="o">=</span><span class="n">development</span> <span class="n">npm</span> <span class="n">start</span>
</pre></div>
</div>
<p>You should see some output indicating that the webpack-dev-server is running on port 4000.</p>
<p>The webpack dev server is configured to use the same SSL certificate and private key as the Flask backend by default.
In some browsers you will have to trust BOTH the python backend on 5443 and the webpack-dev-server on port 4000.</p>
<p>It helps if they are using the same hostname and ssl certificates.</p>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="f1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> <a class="reference external" href="https://webpack.js.org/configuration/dev-server/">webpack-dev-server</a>.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="architecture.html" title="previous chapter (use the left arrow)">Architecture</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="../../api/index.html" title="next chapter (use the right arrow)">API Reference</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../http-routingtable.html" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../api/index.html" title="API Reference"
             >next</a> |</li>
        <li class="right" >
          <a href="architecture.html" title="Architecture"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">commandment 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Developer Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Developer Guide</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2017, Jesse Peterson, Mosen. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>